development:
  environment:
   - platform: android
   - language: java1.8

  build:
   - script:
     - cd NativeExtensionProject-Android
     - git checkout $BRANCH
     - bash configure_workspace.sh from_bundles
   - gradle:
       lifecycle: clean assemble
   - script:
     - echo "ESTAMOS EN DEV"

  publish:
   - maven:
       file: INGDirectNative-Android/build/outputs/apk/INGDirectNative-Android-debug-unaligned.apk
       artifactId: nativeframe
       groupId: es.ingdirect.android
       packaging: apk
       url: http://madprdci.ingdirect.es:8080/artifactory/ingdirect-architecture-snapshots
       snapshot: True
       generatePom: True
       repositoryId: ingdirect-architecture-snapshots
       opts: -q -B -U -s /home/jenkins/.m2/settings.xml

  deploy:
   - ansible:
       inventory: ${ANSIBLE_HOME}/environments/development
       playbook: ${ANSIBLE_HOME}/playbooks/deploy_nativeapps.yml
       platform: ANDROID
       packaging: apk
       artifact_group: es.ingdirect.android
       artifact_id: NATIVEFRAME
       version: latest
   - script:
     - perl /home/jenkins/CLI/utils/nativeapps/generate_index.pl -c "/home/jenkins/.ssh/jenkins.rsa"


integration:
  environment:
   - platform: android
   - language: java1.8

  build:
   - script:
     - cd NativeExtensionProject-Android
     - git checkout $BRANCH
     - bash configure_workspace.sh from_bundles
     - echo "ESTAMOS EN INT"
   - gradle:
       lifecycle: clean assemble

  publish:
   - maven:
       file: INGDirectNative-Android/build/outputs/apk/INGDirectNative-Android-debug-unaligned.apk
       artifactId: nativeframe
       groupId: es.ingdirect.android
       packaging: apk
       url: http://madprdci.ingdirect.es:8080/artifactory/ingdirect-architecture-snapshots
       snapshot: True
       generatePom: True
       repositoryId: ingdirect-architecture-snapshots
       opts: -q -B -U -s /home/jenkins/.m2/settings.xml

  deploy:
   - ansible:
       inventory: ${ANSIBLE_HOME}/environments/development
       playbook: ${ANSIBLE_HOME}/playbooks/deploy_nativeapps.yml
       platform: ANDROID
       packaging: apk
       artifact_group: es.ingdirect.android
       artifact_id: NATIVEFRAME
       version: latest
   - script:
     - perl /home/jenkins/CLI/utils/nativeapps/generate_index.pl -c "/home/jenkins/.ssh/jenkins.rsa"

